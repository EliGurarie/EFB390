<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>How to model just about anything (but especially habitat) Part II</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr. Elie Gurarie" />
    <meta name="date" content="2024-10-03" />
    <script src="Lecture_Modeling_PartII_files/header-attrs-2.25/header-attrs.js"></script>
    <link href="Lecture_Modeling_PartII_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="Lecture_Modeling_PartII_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="Lecture_Modeling_PartII_files/fabric-4.3.1/fabric.min.js"></script>
    <link href="Lecture_Modeling_PartII_files/xaringanExtra-scribble-0.0.1/scribble.css" rel="stylesheet" />
    <script src="Lecture_Modeling_PartII_files/xaringanExtra-scribble-0.0.1/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#FF0000"],"pen_size":3,"eraser_size":30,"palette":[]}) })</script>
    <link href="Lecture_Modeling_PartII_files/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="Lecture_Modeling_PartII_files/tile-view-0.2.6/tile-view.js"></script>
    <script src="Lecture_Modeling_PartII_files/kePrint-0.0.1/kePrint.js"></script>
    <link href="Lecture_Modeling_PartII_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="mycss.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, white, title-slide

.title[
# How to model just about anything<br>(but especially habitat) Part II
]
.subtitle[
## EFB 390: Wildlife Ecology and Management
]
.author[
### Dr. Elie Gurarie
]
.date[
### October 3, 2024
]

---


&lt;!-- https://bookdown.org/yihui/rmarkdown/xaringan-format.html --&gt;













.pull-left-70[
# Linear modeling 

... is a very general method to quantifying relationships among variables.  

.pull-left[
![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;
]
.pull-right[

`\(X_i\)` - is called:
- covariate
- independent variable
- explanatory variable

`\(Y_i\)` - is the property we are interested in modeling:
- response variable
- dependent variable

## Goals:

- Fitting a model (usually with Maximum Likelihood)
- Selecting a model (often with AIC)

]
]


.pull-right-30[
![](images/pups_small.jpg)

Steller sea lion (*Eumatopias jubatus*) pups.  

]


---
# Models of Sea Lion Weight

.pull-left-70[

### Null (linear) model

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-4-1.png)&lt;!-- --&gt;


``` r
mean(pups$Weight)
```

```
## [1] 33.51004
```

``` r
sd(pups$Weight)
```

```
## [1] 5.661695
```
]

.pull-right-30[


![](images/pups_small.jpg)

This suggests a model!  

`$$W \sim {\cal N}(\mu = 33\,kg, \sigma = 5.7)$$`
With no covariates. 

]

---
.pull-left-70[

# Simple linear model

*Probably* there is a relationship between length and weight.  The simplest relationship is linear. 


`$$\large Y \sim {  N (\text{mean} = \beta_0 + \beta_1 X,\,\, \text{sd} = \sigma)}$$`

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
]


.pull-right-30[
![](images/pups_small.jpg)

Steller sea lion (*Eumatopias jubatus*) pups.  
]

---

.pull-left[
## Deterministic model:

`$$Y_i = \beta_0 + \beta_1 X_i$$`

- `\(\beta_0\)` - intercept
- `\(\beta_1\)` - slope

This is the **functional form of the predictor**
]

.pull-right[
## Statistical model:

**Version 1:**

`$$Y_i = \beta_0 + \beta_1 X_i + \epsilon_i$$`
where `\(\epsilon_i \sim {\cal N}(0, \sigma)\)`


or

**Version 2:**

`$$Y_i \sim {\cal N}(\beta_0 + \beta_1 X_i, \sigma)$$`
]

V2 is better because it is more transparent about the number of parameters!  

- Two (intercept | slope) are part of the **functional form** 
- One (residual standard deviation) is part of the **random component**. 

---

## But other variables might influence pup size





.pull-left-30[
Lots of competing models with different **main** and **interaction** effects. 
]

.pull-right-70[
![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;
]

---



.pull-left-60.small[

## **Model Selection**


&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Model &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; R2 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; logLik &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; AIC &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; dAIC &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;background-color: yellow !important;"&gt; Weight ~ Length * Sex + Island &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;background-color: yellow !important;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;background-color: yellow !important;"&gt; 0.818 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;background-color: yellow !important;"&gt; -1144.6 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;background-color: yellow !important;"&gt; 2307.3 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;background-color: yellow !important;"&gt; 0.0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Length * Sex * Island &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.824 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1137.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2316.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Length + Sex + Island &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.811 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1155.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2325.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Length * Sex &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.803 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1164.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2339.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Length + Sex &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.795 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1174.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2357.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Length &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.779 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1193.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2392.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 85.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Sex &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.293 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1483.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2972.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 665.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ Island &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.028 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1562.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3137.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 829.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Weight ~ 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1569.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3143.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 835.8 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&gt; More or less what we expect ... the interaction between **sex** and **length** is consistent across islands, but there are some main effect differences across islands (mainly because of the time we sampled).
]

--

.pull-right-40.small[

### Components of a `\(\Delta\)`AIC table

**Degrees of freedom *k*:**

Number of estimated parameters. Measure of *complexity*. 

**Coefficient of determination R&lt;sup&gt;2&lt;/sup&gt;:**  

Percent variation explained. It ALWAYS increases the more complex the model.&lt;br&gt;
Always zero for the **NULL** model. 

**log-likelihood `\(\log({\cal L})\)`:**  

Total probability score of model. It ALWAYS increases the more complex the model.

**Akaike Information Criterion:**  

- `\(AIC = -2 \log({\cal L}) + 2\,k\)`
- Smaller is better
- Grows if **model fit is bad**
- Grows if **model complexity is too high**. 
- .red[**The lowest AIC value is the "best" model.**] 
- (but within 2 `\(\Delta AIC\)` is pretty much equivalent to best)
]

 

---

## Model selection vs. parameter estimates

The best model: 

`$$Y_{ijk} = \beta_{sex} + \beta_{island} \text{Island}_{ijk} + (\beta_{length} \times\text{Length}_{ijk}) + \epsilon_{ijk}$$`

.pull-left[

What are the **parameter estimates** (effect sizes) of the selected model? 

.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; SexFemale &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -39.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.69 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -10.67 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; SexMale &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -59.29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.06 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -19.37 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Length &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.03 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; IslandChirpoev &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5.81 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; IslandLovushki &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.47 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; IslandRaykoke &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.45 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.31 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.19 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; IslandSrednova &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.32 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; SexMale:Length &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.04 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

]]

.pull-right[
![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;
]


---
background-image: url('images/AfricanUngulatesBiomass.png')
background-size: cover

## AIC in action: **What predicts ungulate body size?**

Quality (Nitrogen)? or Type (browse/grass)? 

---
background-image: url('images/GurarieSpringMigrations0.png')
background-size: cover

.pull-left-60[


&lt;!-- &lt;video width="100%" controls="controls"&gt; --&gt; 

&lt;iframe src="https://esf0-my.sharepoint.com/personal/egurarie_esf_edu/_layouts/15/embed.aspx?UniqueId=75126850-958b-4f5a-8e01-69137cacd16a&amp;embed=%7B%22ust%22%3Atrue%2C%22hv%22%3A%22CopyEmbedCode%22%7D&amp;referrer=StreamWebApp&amp;referrerScenario=EmbedDialog.Create" width="640" height="360" frameborder="0" scrolling="no" allowfullscreen title="migrationanimation6.mp4"&gt;&lt;/iframe&gt;

&lt;/video&gt;
]

.pull-right-40[
## Caribou spring migrations

Remarkable temporal synchrony at a continental scale. 
]

---
background-image: url('images/GurarieSpringMigrations.png')
background-size: cover

## Could the synchrony be driven by global weather drivers?

.pull-right-70[
Pacific Decadal Oscillation, Arctic Oscillation, North Atlantic Oscillation:  determine whether the winter is wet &amp; snowy or dry &amp; cold. 
]

---
background-image: url('images/GurarieSpringMigrations2.png')
background-size: cover

## `\(\Delta\)`AIC Table 1: **Departure time** 

.pull-right[... driven by LARGE climate oscillations.]

---
background-image: url('images/GurarieSpringMigrations3.png')
background-size: cover

## `\(\Delta\)`AIC Table 2: **Arrival time** 

.pull-right[... completely independent of climate!]

---
class: small

.pull-left[
## **Generalized** linear modeling

### Normal Model

.large[$$Y_i \sim {\cal Normal}(\alpha_0 + \beta_1 X_i, \sigma)$$]
Models continuous data with a "normal-like" distribution.

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-13-1.png)&lt;!-- --&gt;
]

--

.pull-right[
### Binomial model

.large[$$Y_i \sim {\cal Bernoulli}\left( \frac{\exp(\alpha + \beta X_i)}{1 + \exp(\alpha + \beta X_i)} \right)$$]

There's some *probability* of something happening that depends on the predictor `\(X\)`.  

**Bernoulli** just means the data are all 0 or 1. 

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;

This models **presence/absence**, **dead/alive**, **male/female** other response variables with **2** possible outcomes. 
]

---
background-image: url('images/SoleaSolea.png')
background-size: cover

### What factors predict occurence of *Solea solea* larvae?

Sampled in the estuary of the Tejo river in Portugal

- Lots of environmental factors in data

.pull-right-70[.footnotesize[
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; depth &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; temp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; salinity &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; transp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gravel &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; large_sand &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; fine_sand &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mud &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; presence &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.74 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.93 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.18 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.94 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.99 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.43 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 87.63 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.88 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.98 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.85 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.29 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.06 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21.95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55.03 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.87 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.49 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42.04 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.45 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.39 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.43 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50.72 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]]

---

# Presence of *Solea solea* against **salinity**

.pull-left-40[
![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;
]

.pull-right-60[

Modeling is EXACTLY the same as **linear regression** except:
- `glm` - for **generalized** linear model (instead of `lm`)
- `family = 'binomial'` is the instruction to fit the logistic regression


`glm(presence ~ salinity, family ='binomial')`


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Std. Error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; z value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Pr(&amp;gt;|z|) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.661 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.902 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.951 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.003 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; salinity &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.130 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.035 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.716 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

Clearly - *Solea solea* presence is very significantly *negatively* related to salinity.  
]


---
### Out of this model we can make predictions


&lt;img src="Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-19-1.png" width="80%" /&gt;

---

.pull-left[

## `\(\Delta\)`AIC analysis - and coefficients



&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Model &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; logLik &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; AIC &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; dAIC &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;font-weight: bold;color: darkblue !important;background-color: yellow !important;"&gt; M9 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;font-weight: bold;color: darkblue !important;background-color: yellow !important;"&gt; salinity + gravel &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;font-weight: bold;color: darkblue !important;background-color: yellow !important;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;font-weight: bold;color: darkblue !important;background-color: yellow !important;"&gt; -33.2 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;font-weight: bold;color: darkblue !important;background-color: yellow !important;"&gt; 72.5 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;font-weight: bold;color: darkblue !important;background-color: yellow !important;"&gt; 0.0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; M2 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; salinity &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; -34.3 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 72.6 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 0.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; M7 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; temp + salinity &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; -34.0 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 74.0 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 1.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; M5 &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; depth + salinity &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; -34.1 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 74.3 &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;color: darkblue !important;background-color: lightgreen !important;"&gt; 1.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M11 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; depth + temp + salinity &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -33.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; depth &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -38.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 80.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; depth + temp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -38.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 81.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; depth + gravel &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -38.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; depth + temp + gravel &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -37.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 83.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; temp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -43.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 90.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; gravel &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -43.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 91.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; M8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; temp + gravel &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -43.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 92.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20.1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.pull-right[
**Salinity** clearly among the more important covariates (in the top 4 models). 

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-22-1.png)&lt;!-- --&gt;

]


---
class: inverse 
.pull-left-20[
### We interrupt your regularly scheduled lecture for a special guest presentation... 
]
.pull-right-80[![](PCH_RSF.png)]


---
# **Poisson regression**

.pull-left-30[

![](images/Poisson1.png)
![](images/Poisson4.png)
![](images/Poisson10.png)

]

.pull-right-70[

.large[$$Y_i \sim {\cal Poisson}\left(\lambda = \exp(\alpha + \beta X_i) \right)$$]

- We are **counting** something ... the data are between 0 and `\(\infty\)` 
- `\(\lambda\)` is a **density**;  **densities** vary across habitat types (covariate **X**). 

.center[&lt;img src='images/Moose2.png' width='70%'/&gt;]
]


---

## Field flags

.large[**Did flag densities vary with region?**]

.pull-left-40[

Approximate areas:

region | area
--|--
**North:** | 82 m&lt;sup&gt;2&lt;/sup&gt;
**South:** | 82 m&lt;sup&gt;2&lt;/sup&gt;
**Perimeter:** | 196 m&lt;sup&gt;2&lt;/sup&gt;
--|--
**Sampling square (Circle)** | 0.5 m&lt;sup&gt;2&lt;/sup&gt;
]
.pull-right-60[

![](images/court.png)]


---


.pull-left[

### Count data




```
##      Section
## Count  N  P  S
##     0  9 10  9
##     1  8  2  6
##     2  4  2  4
##     3  2  0  2
##     4  0  0  1
```

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-24-1.png)&lt;!-- --&gt;
]

.pull-right[

### Fitting models

.large[
`glm(count ~ region, family = 'poisson')`

Exact same syntax as before, except the "family" is **Poisson.** 
]]


---

.pull-left[

### Count data





```
##      Section
## Count  N  P  S
##     0  9 10  9
##     1  8  2  6
##     2  4  2  4
##     3  2  0  2
##     4  0  0  1
```

![](Lecture_Modeling_PartII_files/figure-html/unnamed-chunk-26-1.png)&lt;!-- --&gt;
]

.pull-right[

### Fitting models


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Std. Error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; z value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Pr(&amp;gt;|z|) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.044 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.213 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.208 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.835 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; RegionPerimeter &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.803 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.461 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.743 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.081 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; RegionSouth &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.295 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.656 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

The **intercept** here is "North", the *p*-values compare with North.  So **Perimeter** has somewhat lower density (but not significantly).  

#### `\(\Delta AIC\)` table

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; AIC &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Null.model &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 153.69 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Region.model &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 152.50 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

These models have very similar AIC, but Region is *slightly* significant

]


---

### Making predictions

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Region &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; area &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; fit &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; se.fit &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; d.hat &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; d.low &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; d.high &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; N.hat &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; N.low &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; N.high &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; South &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.087 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.204 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.091 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.725 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.641 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 89.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 134.6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; North &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.044 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.213 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.957 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.624 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.465 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 78.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 51.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 120.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Perimeter &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 196 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.847 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.408 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.429 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.189 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.970 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 84.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 190.1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

.small[
- **fit** and **se.fit** are in the log scale, so they need to be transformed via `\(exp\)` to intensities `\(\lambda\)`. 

- `l.hat` is the Poisson intensity `\(\lambda\)` of the sampling square (**hula hoop**), which we turn into an actual density by dividing by its area **0.5 m&lt;sup&gt;2&lt;/sup&gt;**.

- `d.hat` (and `d.low` and `d.high`) are the density estimates &amp; confidence intervals, which we then turn into our numerical predictions by multiplying by area. 
]

### Total estimate

.large.green[ 
`$$\widehat{N} = 252 \,\, (95\%\, \text{C.I.}: 182 - 322)$$`
]

**pretty ok!**  The true values were ~ 210 total 




---
background-image:  url('images/LEGO.jpg')
background-size: cover

.content-box-blue[

## .darkred[**Take-aways on (linear, statistical) modeling**]

1. **Linear modeling** separates **patterns** (the model) from "**randomness**" (unexplained variation).

2. We structure our models to have a **response variable** and one or more **predictors** or **covariates**. 

3. Depending on the reponse variable, a different **family** is chosen:
  - if **continuous** and symmetric: **Normal** family
  - if two values (presence/absence, dead/alive): **Binomial** family
  - if count data: **Poisson** family. 

3. An important task is **Model selection**, identifying which model is "best" 
  - Best means *"explains the most variation without overfitting"* 
  - Very common criterion is **AIC.**
  
4. Once a model is "selected", we can:
  - analyze the results by seeing the **effect sizes** (magnitude of coefficients, aka *slopes*) and **directions** (signs of coefficients) 
  - make **inferential predictions** by "spreading" our model over a larger landscape.
  
6. **Well over 90% of habitat modeling is done this way!**
  
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false,
"highlightLines": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
